# putty_auto_launch
JS×PuTTYでサーバーへの接続を自動化する
## 背景
新しいツールを一切追加できないPCでGUIを使って複数サーバーへのアクセスを自動化したかった  
条件はこんな感じ
* PC：Windows Server
* インストール言語：なし
* Excel：なし
* ブラウザ：IE or Chrome
* 外部へのインターネットアクセス：不可
* ターミナル：PuTTY
* 接続先のIPはWEBで管理されている
## 動作環境
Windows IEのみ  
IE11で動確    
Chromeだとローカルファイルをいじれないので不可
## 事前準備
PuTTYをインストールしておく  
秘密鍵を使う場合はPuTTYgenでPPKファイルに変換しておく  
  
今回対象のIPはWEB画面のテーブルで一覧表示されている想定なので、別の形式から取り込む場合はテーブルタグに変換しておく  
※サンプルとして[html/sample.html](html/sample.html)を用意
## 使い方
1. [html/index.html](html/index.html)をIEで開く
1. ブラウザで接続先のIP一覧のテーブルを表示して`<table>~</table>`までをコピーする
1. コピーしたテーブルタグをindex.htmlに貼り付け
1. テーブル読み込みボタンをクリックすると画面下にテーブルが読み込まれる
1. 接続したいサーバーにチェック
    1. リストでフィルター
    1. ヘッダーのチェックボックスで全選択/全解除
1. ユーザーID～PPKファイルのパスを入力する
    1. 今回は秘密鍵を使ったのでユーザーパスワードは未使用
1. PuTTY起動ボタンをクリックすると選択したIPそれぞれに接続した画面が起動する
    1. 初回のみ「このActiveXコントロールは、安全でない可能性があり…」というダイアログが出るので「はい」をクリック
## 備考
* Windows10では確認したけど、Windows Serverでは未確認
    * Windows Serverはセキュリティ設定が厳しいので、そのままだと動かないかも
    * ブラウザのセキュリティ設定を変えるか、CMDで実行する用のコマンドを吐き出してコピペ実行にするか？
* 操作ページのデザインは力尽きたので最低限しかやってない  
* 汎用性はないので、使う場合はそれぞれの状況に合わせてカスタマイズが必要
* PuTTYを起動すると、背後霊のようにCMDが付きまとう
    * PuTTYを閉じると消える
    * こいつを起動しない方法が不明
    * PuTTYが3.5MB、CMDが1MB = 1ウィンドウあたり4.5MB程度のメモリを使用するので、大量に接続する場合は余力に注意
* 今どきPuTTY。。。
    * ウィンドウをタブ表示できるRLOGINが正義
    * RLOGIN × Excel VBAでの自動化が余計な環境作らなくてすんで便利


